<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="对标签聚合算法 (真值推断) Dawid-Skene 算法进行一些较为深入讨论。 所谓标签聚合算法，是指从多个标注者的标注结果中推断出最可靠的标签。
"><meta name=author content="Xiangzhuang Shen"><link href=https://shenxiangzhuang.github.io/blog/2024/08/21/ds/ rel=canonical><link href=../../../02/07/lifelong-2023/ rel=prev><link href=../../../11/28/ai-town/ rel=next><link rel=alternate type=application/rss+xml title="RSS 订阅" href=../../../../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="已更新内容的 RSS 订阅" href=../../../../../feed_rss_updated.xml><link rel=icon href=../../../../../assets/logo/glimpse-ai-logo-small.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.42"><title>Dawid-Skene 算法 - Data Honor</title><link rel=stylesheet href=../../../../../assets/stylesheets/main.0253249f.min.css><link rel=stylesheet href=../../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../../css/neoteroi-mkdocs.css><script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-KEEHE7VY5K"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-KEEHE7VY5K",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-KEEHE7VY5K",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#dawid-skene class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label=不再显示此消息> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <center> You can follow by <a href=https://datahonor.com/feed_rss_created> <strong>RSS</strong> </a> or <a href=https://github.com/shenxiangzhuang> <span class=twemoji> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M448 96c0-35.3-28.7-64-64-64H64C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V96zM265.8 407.7c0-1.8 0-6 .1-11.6.1-11.4.1-28.8.1-43.7 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6s-28.4 1.9-41.6 5.6c0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 9 .1 21.7.1 30.6 0 4.8.1 8.6.1 10 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3-8.4 1.5-11.5-3.7-11.5-8zm-90.5-54.8c-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3-1.9.4-3.7-.4-3.9-1.7zm-9.1 3.2c-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4 0 1.3-1.5 2.4-3.5 2.4zm-14.3-2.2c-1.9-.4-3.2-1.9-2.8-3.2s2.4-1.9 4.1-1.5c2 .6 3.3 2.1 2.8 3.4-.4 1.3-2.4 1.9-4.1 1.3zm-12.5-7.3c-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1-.9 1.1-2.8.9-4.3-.6zm-8.5-10c-1.1-1.5-1.1-3.2 0-3.9 1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1-.9.6-2.6 0-3.7-1.5zm-6.3-8.8c-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5-.9.9-2.4.4-3.5-.6zm-6-6.4c-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6-.4.9-1.7 1.1-2.8.4z"/></svg> </span> <strong>GitHub(<strong>shenxiangzhuang</strong>)</strong> </a> <!--  or--> <!--  <a href="https://www.zhihu.com/people/shen-xiang-zhuang">--> <!--    <strong>知乎</strong>--> <!--  </a>--> or <!--暂时用 LLM in 2024 文章链接作为入口--> <a href=https://mp.weixin.qq.com/s/wOqp6nHBAenK9wP2vIUS9g> <span class=twemoji> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 4C5.36 4 2 6.69 2 10c0 1.89 1.08 3.56 2.78 4.66L4 17l2.5-1.5c.89.31 1.87.5 2.91.5A5.22 5.22 0 0 1 9 14c0-3.31 3.13-6 7-6 .19 0 .38 0 .56.03C15.54 5.69 12.78 4 9.5 4m-3 2.5a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m5 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M16 9c-3.31 0-6 2.24-6 5s2.69 5 6 5c.67 0 1.31-.08 1.91-.25L20 20l-.62-1.87C20.95 17.22 22 15.71 22 14c0-2.76-2.69-5-6-5m-2 2.5a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m4 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1Z"/></svg> </span> <strong>WeChat(<strong>AI Glimpse</strong>)</strong> </a> </center> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../../../.. title="Data Honor" class="md-header__button md-logo" aria-label="Data Honor" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M6.27 17.05A2.991 2.991 0 0 1 4 22c-1.66 0-3-1.34-3-3s1.34-3 3-3c.18 0 .36 0 .53.05l3.07-5.36-1.74-.99 4.09-1.12 1.12 4.09-1.74-.99zM20 16c-1.3 0-2.4.84-2.82 2H11v-2l-3 3 3 3v-2h6.18c.42 1.16 1.52 2 2.82 2 1.66 0 3-1.34 3-3s-1.34-3-3-3m-8-8c.18 0 .36 0 .53-.05l3.07 5.36-1.74.99 4.09 1.12 1.12-4.09-1.74.99-3.06-5.37A2.991 2.991 0 0 0 12 2c-1.66 0-3 1.34-3 3s1.34 3 3 3"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Honor </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Dawid-Skene 算法 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=cyan data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" title=分享 aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/shenxiangzhuang/shenxiangzhuang.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Xiangzhuang Shen'S Blog </div> </a> </div> </nav> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../../../datascience/ class=md-tabs__link> Data Science </a> </li> <li class=md-tabs__item> <a href=../../../../../cs/ class=md-tabs__link> Computer Science </a> </li> <li class=md-tabs__item> <a href=../../../../../se/ class=md-tabs__link> Software Engineering </a> </li> <li class=md-tabs__item> <a href=../../../../../odyssey/ class=md-tabs__link> Career Odyssey </a> </li> <li class=md-tabs__item> <a href=../../../../../tool/ class=md-tabs__link> Tool </a> </li> <li class=md-tabs__item> <a href=../../../../../project/ class=md-tabs__link> Project </a> </li> <li class=md-tabs__item> <a href=../../../../../life/ class=md-tabs__link> Life </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../../../ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../.. title="Data Honor" class="md-nav__button md-logo" aria-label="Data Honor" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M6.27 17.05A2.991 2.991 0 0 1 4 22c-1.66 0-3-1.34-3-3s1.34-3 3-3c.18 0 .36 0 .53.05l3.07-5.36-1.74-.99 4.09-1.12 1.12 4.09-1.74-.99zM20 16c-1.3 0-2.4.84-2.82 2H11v-2l-3 3 3 3v-2h6.18c.42 1.16 1.52 2 2.82 2 1.66 0 3-1.34 3-3s-1.34-3-3-3m-8-8c.18 0 .36 0 .53-.05l3.07 5.36-1.74.99 4.09 1.12 1.12-4.09-1.74.99-3.06-5.37A2.991 2.991 0 0 0 12 2c-1.66 0-3 1.34-3 3s1.34 3 3 3"/></svg> </a> Data Honor </label> <div class=md-nav__source> <a href=https://github.com/shenxiangzhuang/shenxiangzhuang.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Xiangzhuang Shen'S Blog </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../.. class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../datascience/ class=md-nav__link> <span class=md-ellipsis> Data Science </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../cs/ class=md-nav__link> <span class=md-ellipsis> Computer Science </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../se/ class=md-nav__link> <span class=md-ellipsis> Software Engineering </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../odyssey/ class=md-nav__link> <span class=md-ellipsis> Career Odyssey </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../tool/ class=md-nav__link> <span class=md-ellipsis> Tool </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../project/ class=md-nav__link> <span class=md-ellipsis> Project </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../life/ class=md-nav__link> <span class=md-ellipsis> Life </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9 checked> <div class="md-nav__link md-nav__container"> <a href=../../../../ class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> <label class="md-nav__link " for=__nav_9 id=__nav_9_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=true> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_2> <label class=md-nav__link for=__nav_9_2 id=__nav_9_2_label tabindex> <span class=md-ellipsis> 归档 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_2_label aria-expanded=false> <label class=md-nav__title for=__nav_9_2> <span class="md-nav__icon md-icon"></span> 归档 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../archive/2025/ class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2024/ class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2023/ class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2022/ class=md-nav__link> <span class=md-ellipsis> 2022 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2021/ class=md-nav__link> <span class=md-ellipsis> 2021 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2019/ class=md-nav__link> <span class=md-ellipsis> 2019 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2018/ class=md-nav__link> <span class=md-ellipsis> 2018 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_3> <label class=md-nav__link for=__nav_9_3 id=__nav_9_3_label tabindex> <span class=md-ellipsis> 分类 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_3_label aria-expanded=false> <label class=md-nav__title for=__nav_9_3> <span class="md-nav__icon md-icon"></span> 分类 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../category/ai/ class=md-nav__link> <span class=md-ellipsis> AI </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/engineering/ class=md-nav__link> <span class=md-ellipsis> Engineering </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/llm/ class=md-nav__link> <span class=md-ellipsis> LLM </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/mle/ class=md-nav__link> <span class=md-ellipsis> MLE </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/odyssey/ class=md-nav__link> <span class=md-ellipsis> Odyssey </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/paper/ class=md-nav__link> <span class=md-ellipsis> Paper </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/project/ class=md-nav__link> <span class=md-ellipsis> Project </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/statistics/ class=md-nav__link> <span class=md-ellipsis> Statistics </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E4%B9%A6%E8%AF%84/ class=md-nav__link> <span class=md-ellipsis> 书评 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E5%9B%9E%E5%BF%86%E5%BD%95/ class=md-nav__link> <span class=md-ellipsis> 回忆录 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E5%BC%80%E6%BA%90/ class=md-nav__link> <span class=md-ellipsis> 开源 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 数据分析 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E6%96%87%E5%AD%A6/ class=md-nav__link> <span class=md-ellipsis> 文学 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E6%97%A5%E8%AE%B0/ class=md-nav__link> <span class=md-ellipsis> 日记 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E7%AE%97%E6%B3%95/ class=md-nav__link> <span class=md-ellipsis> 算法 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E7%BB%88%E8%BA%AB%E5%AD%A6%E4%B9%A0/ class=md-nav__link> <span class=md-ellipsis> 终身学习 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/%E9%9A%8F%E7%AC%94/ class=md-nav__link> <span class=md-ellipsis> 随笔 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 简介 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 算法原理 </span> </a> <nav class=md-nav aria-label=算法原理> <ul class=md-nav__list> <li class=md-nav__item> <a href=#em class=md-nav__link> <span class=md-ellipsis> EM 算法推导 </span> </a> </li> <li class=md-nav__item> <a href=#dawid-skene_1 class=md-nav__link> <span class=md-ellipsis> Dawid-Skene 算法推导 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 工程实现 </span> </a> <nav class=md-nav aria-label=工程实现> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 核心算法实现 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 算法优化 </span> </a> <nav class=md-nav aria-label=算法优化> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 金标题修正标签先验分布 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 能力画像修正混淆矩阵 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../../../../ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> <span class=md-ellipsis> 回到主页 </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=https://avatars.githubusercontent.com/u/17157965 alt="Xiangzhuang Shen"> </span> <span class=md-profile__description> <strong> <a href=https://github.com/shenxiangzhuang>Xiangzhuang Shen</a> </strong> <br> Creator </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> 元数据 </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg> <time datetime="2024-08-21 00:00:00" class=md-ellipsis>2024年8月21日</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg> <span class=md-ellipsis> 分类于 <a href=../../../../category/%E7%AE%97%E6%B3%95/ >算法</a>, <a href=../../../../category/%E5%BC%80%E6%BA%90/ >开源</a>, <a href=../../../../category/mle/ >MLE</a>, <a href=../../../../category/odyssey/ >Odyssey</a></span> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg> <span class=md-ellipsis> 需要 6 分钟阅读时间 </span> </div> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <a href=https://github.com/shenxiangzhuang/shenxiangzhuang.github.io/edit/master/docs/blog/posts/ds.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/shenxiangzhuang/shenxiangzhuang.github.io/raw/master/docs/blog/posts/ds.md title=查看本页的源代码 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <div><h1 id=dawid-skene>Dawid-Skene 算法<a class=headerlink href=#dawid-skene title="Permanent link">¶</a></h1> <p><img alt src=../../../../images/ds_position.png></p> <p>Lilian 在<a href=https://lilianweng.github.io/posts/2024-02-05-human-data-quality/ >Thinking about High-Quality Human Data | Lil'Log</a> 对数据标注的质量进行了一些很有远见的讨论。 这里我们主要对标签聚合算法 (真值推断) Dawid-Skene 算法进行一些较为深入讨论。</p> <p>所谓标签聚合算法，是指从多个标注者的标注结果中推断出最可靠的标签。</p> <h2 id=_1>简介<a class=headerlink href=#_1 title="Permanent link">¶</a></h2> <p>Dawid-Skene 算法最早是应用于临床医学相关的领域， 用于聚合多个临床专家对同一个病人的的判断结果。 后来被广泛应用于数据标注领域，用于聚合多个标注结果得到最可靠的标签。</p> <!-- more --> <h2 id=_2>算法原理<a class=headerlink href=#_2 title="Permanent link">¶</a></h2> <figure> <img alt="DS Algorithm" src=https://tlk.s3.yandex.net/crowd-kit/docs/ds_llm.png> <figcaption>DS 算法的概率图模型 (Image source: Crowd-Kit)</figcaption> </figure> <p>DS 算法是一种基于 EM 算法的标签聚合算法，我们先简要介绍 EM 算法的原理，然后再介绍 DS 算法的细节。</p> <h3 id=em>EM 算法推导<a class=headerlink href=#em title="Permanent link">¶</a></h3> <p><em>The Expectation Maximization Algorithm: A short tutorial</em><sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup> 给出了一个极为详细的 EM 算法推导。</p> <details class=note> <summary>Read the paper right now!</summary> <p><embed alt="The Expectation Maximization Algorithm" src=../../../../pdf/em_algo_intro.pdf style=min-height:100vh;width:100% type=application/pdf></p> </details> <h3 id=dawid-skene_1>Dawid-Skene 算法推导<a class=headerlink href=#dawid-skene_1 title="Permanent link">¶</a></h3> <p><em>Maximum likelihood estimation of observer error-rates using the EM algorithm</em><sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup> 是 DS 算法的原始论文，给出了 DS 算法的推导。</p> <details class=note> <summary>Read the paper right now!</summary> <p><embed alt="Maximum likelihood estimation of observer error-rates using the EM algorithm" src=../../../../pdf/ds_paper.pdf style=min-height:100vh;width:100% type=application/pdf></p> </details> <p>论文本身的推导过程还算比较完善的，不过省略了较为关键的极大似然估计的推导过程，也就是通过 <strong>式 2.2</strong>:</p> <div class=arithmatex>\[ L = \prod_{i=1}^I \prod_{j=1}^J \left\{p_j \prod_{k=1}^K \prod_{l=1}^J (\pi_{jl}^{(k)})^{n_{il}^{(k)}}\right\}^{T_{ij}} \]</div> <p>推导出<strong>式 2.3</strong>:</p> <div class=arithmatex>\[ \hat{\pi}_{jl}^{(k)} = \frac{\sum_{i} T_{ij} n_{il}^{(k)}}{\sum_{l} \sum_{i} T_{ij} n_{il}^{(k)}} \]</div> <p>和<strong>式 2.4</strong>:</p> <div class=arithmatex>\[ \hat{p}_j = \frac{\sum_{i} T_{ij}}{I} \]</div> <p>所谓极大似然估计，就是先定义一个似然函数<span class=arithmatex>\(L\)</span>，然后通过求解<span class=arithmatex>\(L\)</span>的极值来求解参数， 这里求解的关键其实是通过 Lagrange 乘子法 (Lagrange multiplier) 来求解。 因为要求解的参数 <span class=arithmatex>\(\pi_{jl}^{(k)}\)</span> 和 <span class=arithmatex>\(p_j\)</span> 都是概率，所以需要满足概率的约束条件， 我们用 Lagrange 乘子法来满足这个约束条件。 这里我们主要介绍 <span class=arithmatex>\(\pi_{jl}^{(k)}\)</span> 的推导过程，<span class=arithmatex>\(p_j\)</span> 的推导过程类似。</p> <p>因为这里的<span class=arithmatex>\(L\)</span>的形式存在多个乘积，所以我们可以通过对数似然函数来简化计算。</p> <div class=arithmatex>\[ \ln L = \sum_{i=1}^I \sum_{j=1}^J T_{ij} \left[\ln p_j + \sum_{k=1}^K \sum_{l=1}^J n_{il}^{(k)} \ln \pi_{jl}^{(k)}\right] \]</div> <p>作为概率的估计，<span class=arithmatex>\(\pi_{jl}^{(k)}\)</span>的约束条件是：</p> <div class=arithmatex>\[ \sum_{l=1}^J \pi_{jl}^{(k)} = 1 \quad \text{for all } j \text{ and } k \]</div> <p>综合以上条件，我们可以得到 Lagrange 函数：</p> <div class=arithmatex>\[ \mathcal{L} = \ln L + \sum_{j=1}^J \sum_{k=1}^K \lambda_{jk} \left(1 - \sum_{l=1}^J \pi_{jl}^{(k)}\right) \]</div> <p>通过对 <span class=arithmatex>\(\pi_{jl}^{(k)}\)</span> 求偏导，我们可以得到：</p> <div class=arithmatex>\[ \frac{\partial \mathcal{L}}{\partial \pi_{jl}^{(k)}} = \frac{\partial}{\partial \pi_{jl}^{(k)}} \left[\sum_{i=1}^I \sum_{j=1}^J T_{ij} \sum_{k=1}^K \sum_{l=1}^J n_{il}^{(k)} \ln \pi_{jl}^{(k)} - \sum_{j=1}^J \sum_{k=1}^K \lambda_{jk} \sum_{l=1}^J \pi_{jl}^{(k)}\right] \]</div> <p>化简后得到：</p> <div class=arithmatex>\[ \frac{\partial \mathcal{L}}{\partial \pi_{jl}^{(k)}} = \frac{\partial}{\partial \pi_{jl}^{(k)}} \left[\sum_{i=1}^I T_{ij} n_{il}^{(k)} \ln \pi_{jl}^{(k)} - \lambda_{jk} \pi_{jl}^{(k)}\right] = \sum_{i=1}^I T_{ij} \frac{n_{il}^{(k)}}{\pi_{jl}^{(k)}} - \lambda_{jk} \]</div> <p>将上式置为 0，我们可以得到：</p> <div class=arithmatex>\[ \sum_{i=1}^I T_{ij} \frac{n_{il}^{(k)}}{\pi_{jl}^{(k)}} - \lambda_{jk} = 0 \]</div> <p>调整一下顺序，将 <span class=arithmatex>\(\pi_{jl}^{(k)}\)</span> 隔离出来，我们可以得到：</p> <div class=arithmatex>\[ \sum_{i=1}^I T_{ij} n_{il}^{(k)} = \lambda_{jk} \pi_{jl}^{(k)} \]</div> <p>利用约束条件来消除 <span class=arithmatex>\(\pi_{jl}^{(k)}\)</span> 以求解 <span class=arithmatex>\(\lambda_{jk}\)</span>，这里通过两边同时按照 <span class=arithmatex>\(l\)</span> 求和：</p> <div class=arithmatex>\[ \sum_{l=1}^J \sum_{i=1}^I T_{ij} n_{il}^{(k)} = \lambda_{jk} \sum_{l=1}^J \pi_{jl}^{(k)} = \lambda_{jk} \]</div> <p>根据上述两式，我们可以得到最终的 <span class=arithmatex>\(\pi_{jl}^{(k)}\)</span> 的极大似然估计，也就是<strong>式 2.3</strong>：</p> <div class=arithmatex>\[ \hat{\pi}_{jl}^{(k)} = \frac{\sum_{i} T_{ij} n_{il}^{(k)}}{\sum_{l} \sum_{i} T_{ij} n_{il}^{(k)}} \]</div> <p>至此，我们完成了 <span class=arithmatex>\(\pi_{jl}^{(k)}\)</span> 的推导，<span class=arithmatex>\(p_j\)</span> 的推导过程类似，这里不再赘述。</p> <h2 id=_3>工程实现<a class=headerlink href=#_3 title="Permanent link">¶</a></h2> <p>以 <a href=https://github.com/Toloka/crowd-kit/blob/main/crowdkit/aggregation/classification/dawid_skene.py>crowd-kit</a> 的实现代码为例。 先简要介绍 DS 算法核心的实现，然后重点介绍两个算法优化点的具体实现。</p> <h3 id=_4>核心算法实现<a class=headerlink href=#_4 title="Permanent link">¶</a></h3> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>DawidSkene</span><span class=p>(</span><span class=n>BaseClassificationAggregator</span><span class=p>):</span>
    <span class=c1># 省略部分代码</span>
    <span class=k>def</span> <span class=nf>fit</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
        <span class=n>true_labels</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=s2>"pd.Series[Any]"</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
        <span class=n>initial_error</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>"DawidSkene"</span><span class=p>:</span>
        <span class=c1># 省略部分代码</span>
        <span class=c1># Initialization</span>
<span class=hll>        <span class=n>probas</span> <span class=o>=</span> <span class=n>MajorityVote</span><span class=p>()</span><span class=o>.</span><span class=n>fit_predict_proba</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>  <span class=c1># (1)</span>
</span>        <span class=c1># correct the probas by true_labels</span>
        <span class=k>if</span> <span class=n>true_labels</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>probas</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_correct_probas_with_golden</span><span class=p>(</span><span class=n>probas</span><span class=p>,</span> <span class=n>true_labels</span><span class=p>)</span>
<span class=hll>        <span class=n>priors</span> <span class=o>=</span> <span class=n>probas</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>  <span class=c1># (2)</span>
</span><span class=hll>        <span class=n>errors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_m_step</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>probas</span><span class=p>,</span> <span class=n>initial_error</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>initial_error_strategy</span><span class=p>)</span>  <span class=c1># (3)</span>
</span>        <span class=n>loss</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>loss_history_</span> <span class=o>=</span> <span class=p>[]</span>

        <span class=c1># Updating proba and errors n_iter times</span>
        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_iter</span><span class=p>):</span>
<span class=hll>            <span class=n>probas</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_e_step</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>priors</span><span class=p>,</span> <span class=n>errors</span><span class=p>)</span>  <span class=c1># (4)</span>
</span>            <span class=c1># correct the probas by true_labels</span>
            <span class=k>if</span> <span class=n>true_labels</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>probas</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_correct_probas_with_golden</span><span class=p>(</span><span class=n>probas</span><span class=p>,</span> <span class=n>true_labels</span><span class=p>)</span>
<span class=hll>            <span class=n>priors</span> <span class=o>=</span> <span class=n>probas</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>  <span class=c1># (5)</span>
</span><span class=hll>            <span class=n>errors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_m_step</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>probas</span><span class=p>)</span>  <span class=c1># (6)</span>
</span>            <span class=n>new_loss</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_evidence_lower_bound</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>probas</span><span class=p>,</span> <span class=n>priors</span><span class=p>,</span> <span class=n>errors</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span>
                <span class=n>data</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>loss_history_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_loss</span><span class=p>)</span>

            <span class=k>if</span> <span class=n>new_loss</span> <span class=o>-</span> <span class=n>loss</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span><span class=p>:</span>
                <span class=k>break</span>
            <span class=n>loss</span> <span class=o>=</span> <span class=n>new_loss</span>
        <span class=c1># 省略部分代码</span>
</code></pre></div></td></tr></table></div> <ol> <li><code>MajorityVote</code>是一个简单的多数投票算法，用于初始化标签的概率分布。</li> <li><code>priors</code>是标签的先验概率。</li> <li><code>errors</code>是 worker 标注的 confusion matrix。</li> <li>EM 算法的 E 步：根据标注数据<code>data</code>，标签的先验分布<code>prioir</code>和 worker 的混淆矩阵<code>errors</code>来更新标签的概率分布。</li> <li>更新标签的先验概率。</li> <li>EM 算法的 M 步：根据标注数据<code>data</code>和标签的概率分布<code>probas</code>来更新 worker 的混淆矩阵<code>errors</code>。</li> </ol> <h3 id=_5>算法优化<a class=headerlink href=#_5 title="Permanent link">¶</a></h3> <p>这里做的优化主要有两处，分别对应 DS 算法中两个缺失的参数： 标签的先验分布<code>priors</code>和标注人员的混淆矩阵<code>errors</code>。</p> <h4 id=_6>金标题修正标签先验分布<a class=headerlink href=#_6 title="Permanent link">¶</a></h4> <p>那么如果在数据集中有一些题目的真值标签 (即为金标题)，我们如何利用上这部分信息让推断更加准确呢？ 通过上面的代码可以看到，在没有真值标签的情况下，<code>priors</code>的初始值是通过多数投票算法得到的。 这里我们可以通过这些真值标签来修正<code>priors</code>。</p> <div class="admonition note"> <p class=admonition-title>PR 链接</p> <p><a href=https://github.com/Toloka/crowd-kit/pull/109>#109: ds support golden question</a></p> </div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>DawidSkene</span><span class=p>(</span><span class=n>BaseClassificationAggregator</span><span class=p>):</span>
    <span class=c1># 省略部分代码</span>
    <span class=k>def</span> <span class=nf>fit</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
        <span class=n>true_labels</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=s2>"pd.Series[Any]"</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
        <span class=n>initial_error</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>"DawidSkene"</span><span class=p>:</span>
        <span class=c1># 省略部分代码</span>
        <span class=c1># Initialization</span>
        <span class=n>probas</span> <span class=o>=</span> <span class=n>MajorityVote</span><span class=p>()</span><span class=o>.</span><span class=n>fit_predict_proba</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
        <span class=c1># correct the probas by true_labels  # (1)</span>
<span class=hll>        <span class=k>if</span> <span class=n>true_labels</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span class=hll>            <span class=n>probas</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_correct_probas_with_golden</span><span class=p>(</span><span class=n>probas</span><span class=p>,</span> <span class=n>true_labels</span><span class=p>)</span>
</span>        <span class=n>priors</span> <span class=o>=</span> <span class=n>probas</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
        <span class=n>errors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_m_step</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>probas</span><span class=p>,</span> <span class=n>initial_error</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>initial_error_strategy</span><span class=p>)</span>  <span class=c1># (3)</span>
        <span class=n>loss</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>loss_history_</span> <span class=o>=</span> <span class=p>[]</span>

        <span class=c1># Updating proba and errors n_iter times</span>
        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_iter</span><span class=p>):</span>
            <span class=n>probas</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_e_step</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>priors</span><span class=p>,</span> <span class=n>errors</span><span class=p>)</span>
            <span class=c1># correct the probas by true_labels  # (2)</span>
<span class=hll>            <span class=k>if</span> <span class=n>true_labels</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span class=hll>                <span class=n>probas</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_correct_probas_with_golden</span><span class=p>(</span><span class=n>probas</span><span class=p>,</span> <span class=n>true_labels</span><span class=p>)</span>
</span>            <span class=n>priors</span> <span class=o>=</span> <span class=n>probas</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
        <span class=c1># 省略部分代码</span>
</code></pre></div></td></tr></table></div> <ol> <li><code>self._correct_probas_with_golden</code>是一个修正标签概率分布的函数，用于根据金标题真值标签修正标签的概率分布。这里是修正初始化的标签概率分布。</li> <li>在每次迭代中，都会根据金标题真值标签修正标签的概率分布。</li> </ol> <h4 id=_7>能力画像修正混淆矩阵<a class=headerlink href=#_7 title="Permanent link">¶</a></h4> <p>在工业界的标注平台中，会对平台内的 worker 构建详细的用户画像用于刻画 worker 的能力。 比如我们可以通过用户历史的做题记录来构建 worker 的历史混淆矩阵。</p> <p>那么我们如何利用这些历史数据来让推断更加准确呢？ 通过上面的代码可以看到，在没有历史混淆矩阵的情况下，<code>errors</code>的初始值是将多数投票的结果作为真值算出来的。 这里我们可以通过这些历史混淆矩阵来修正<code>errors</code>。</p> <div class="admonition note"> <p class=admonition-title>PR 链接</p> <p><a href=https://github.com/Toloka/crowd-kit/pull/114>#114: add init_error for worker init error matrix</a></p> </div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>DawidSkene</span><span class=p>(</span><span class=n>BaseClassificationAggregator</span><span class=p>):</span>
    <span class=c1># 省略部分代码</span>
<span class=hll>    <span class=n>initial_error_strategy</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Literal</span><span class=p>[</span><span class=s2>"assign"</span><span class=p>,</span> <span class=s2>"addition"</span><span class=p>]]</span> <span class=o>=</span> <span class=n>attr</span><span class=o>.</span><span class=n>ib</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>  <span class=c1># (1)</span>
</span>    <span class=c1># 省略部分代码</span>
    <span class=k>def</span> <span class=nf>fit</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
        <span class=n>true_labels</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=s2>"pd.Series[Any]"</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=hll>        <span class=n>initial_error</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>  <span class=c1># (2)</span>
</span>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>"DawidSkene"</span><span class=p>:</span>
        <span class=c1># 省略部分代码</span>
        <span class=c1># Initialization</span>
        <span class=n>probas</span> <span class=o>=</span> <span class=n>MajorityVote</span><span class=p>()</span><span class=o>.</span><span class=n>fit_predict_proba</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
        <span class=c1># correct the probas by true_labels  # (1)</span>
        <span class=k>if</span> <span class=n>true_labels</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>probas</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_correct_probas_with_golden</span><span class=p>(</span><span class=n>probas</span><span class=p>,</span> <span class=n>true_labels</span><span class=p>)</span>
        <span class=n>priors</span> <span class=o>=</span> <span class=n>probas</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=hll>        <span class=n>errors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_m_step</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>probas</span><span class=p>,</span> <span class=n>initial_error</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>initial_error_strategy</span><span class=p>)</span>  <span class=c1># (3)</span>
</span>        <span class=n>loss</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>loss_history_</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=c1># 省略部分代码</span>
</code></pre></div></td></tr></table></div> <ol> <li><code>initial_error_strategy</code>是一个初始化 worker 混淆矩阵的策略，可以是<code>assign</code>或者<code>addition</code>。</li> <li><code>initial_error</code>是 worker 混淆矩阵的初始值，可以是历史混淆矩阵。</li> <li>仅仅在初始化 worker 混淆矩阵时，才会使用<code>initial_error</code>。</li> </ol> <p>通过上面的实现可以到历史混淆矩阵仅仅影响 worker 混淆矩阵的初始化，而不会影响后续的迭代更新。 算法的逻辑是在<code>_m_step</code>内部通过一行的函数调用实现：</p> <div class="admonition tip"> <p class=admonition-title>保持核心代码的整洁</p> <p>这里通过函数调用的方式，使得核心代码的逻辑更加清晰(保证可读性)，也方便后续的维护和扩展。</p> </div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>DawidSkene</span><span class=p>(</span><span class=n>BaseClassificationAggregator</span><span class=p>):</span>
    <span class=c1># 省略部分代码</span>
    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>_m_step</span><span class=p>(</span>
        <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
        <span class=n>probas</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
        <span class=n>initial_error</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
        <span class=n>initial_error_strategy</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Literal</span><span class=p>[</span><span class=s2>"assign"</span><span class=p>,</span> <span class=s2>"addition"</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<span class=w>        </span><span class=sd>"""Performs M-step of the Dawid-Skene algorithm.</span>

<span class=sd>        Estimates the workers' error probability matrix using the specified workers' responses and the true task label probabilities.</span>
<span class=sd>        """</span>
        <span class=n>joined</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>probas</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s2>"task"</span><span class=p>)</span>
        <span class=n>joined</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>"task"</span><span class=p>],</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>errors</span> <span class=o>=</span> <span class=n>joined</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s2>"worker"</span><span class=p>,</span> <span class=s2>"label"</span><span class=p>],</span> <span class=n>sort</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
        <span class=c1># Apply the initial error matrix</span>
<span class=hll>        <span class=n>errors</span> <span class=o>=</span> <span class=n>initial_error_apply</span><span class=p>(</span><span class=n>errors</span><span class=p>,</span> <span class=n>initial_error</span><span class=p>,</span> <span class=n>initial_error_strategy</span><span class=p>)</span>
</span>        <span class=c1># Normalize the error matrix</span>
        <span class=n>errors</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>lower</span><span class=o>=</span><span class=n>_EPS</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>errors</span> <span class=o>/=</span> <span class=n>errors</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>"worker"</span><span class=p>,</span> <span class=n>sort</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

        <span class=k>return</span> <span class=n>errors</span>
</code></pre></div></td></tr></table></div> <p>简单来说，我们通过上游的两个参数<code>initial_error</code>和<code>initial_error_strategy</code>， 在<code>initial_error_apply</code>函数来修正 worker 混淆矩阵的初始化。 从下面的代码可以看到，这种设计方式可以使得<code>initial_error_apply</code>函数是一个纯函数，不会对外部的状态产生影响。</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>initial_error_apply</span><span class=p>(</span>
    <span class=n>errors</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
    <span class=n>initial_error</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span>
    <span class=n>initial_error_strategy</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Literal</span><span class=p>[</span><span class=s2>"assign"</span><span class=p>,</span> <span class=s2>"addition"</span><span class=p>]],</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
    <span class=k>if</span> <span class=n>initial_error_strategy</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>initial_error</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>errors</span>
    <span class=c1># check the index names of initial_error</span>
<span class=hll>    <span class=k>if</span> <span class=n>initial_error</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>names</span> <span class=o>!=</span> <span class=n>errors</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>names</span><span class=p>:</span>  <span class=c1># (1)</span>
</span>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=sa>f</span><span class=s2>"The index of initial_error must be: </span><span class=si>{</span><span class=n>errors</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>names</span><span class=si>}</span><span class=s2>,"</span>
            <span class=sa>f</span><span class=s2>"but got: </span><span class=si>{</span><span class=n>initial_error</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>names</span><span class=si>}</span><span class=s2>"</span>
        <span class=p>)</span>
<span class=hll>    <span class=k>if</span> <span class=n>initial_error_strategy</span> <span class=o>==</span> <span class=s2>"assign"</span><span class=p>:</span>
</span><span class=hll>        <span class=c1># check the completeness of initial_error: all the workers in data should be in initial_error</span>
</span><span class=hll>        <span class=n>mask</span> <span class=o>=</span> <span class=n>errors</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>initial_error</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span><span class=hll>        <span class=k>if</span> <span class=ow>not</span> <span class=n>mask</span><span class=o>.</span><span class=n>all</span><span class=p>():</span>  <span class=c1># (2)</span>
</span>            <span class=n>not_found_workers</span> <span class=o>=</span> <span class=n>errors</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>~</span><span class=n>mask</span><span class=p>]</span><span class=o>.</span><span class=n>get_level_values</span><span class=p>(</span><span class=s2>"worker"</span><span class=p>)</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>"All the workers in data should be in initial_error: "</span>
                <span class=sa>f</span><span class=s2>"Can not find </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>not_found_workers</span><span class=p>)</span><span class=si>}</span><span class=s2> workers' error matrix in initial_error"</span>
            <span class=p>)</span>
<span class=hll>        <span class=c1># if the values in initial_error are probability, check the sum of each worker's error matrix</span>
</span><span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=n>initial_error</span> <span class=o>&lt;=</span> <span class=mf>1.0</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span><span class=o>.</span><span class=n>all</span><span class=p>()</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>allclose</span><span class=p>(</span>
</span><span class=hll>            <span class=n>initial_error</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>"worker"</span><span class=p>,</span> <span class=n>sort</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span> <span class=mf>1.0</span>
</span><span class=hll>        <span class=p>):</span>  <span class=c1># (3)</span>
</span>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                <span class=s2>"The sum of each worker's error matrix in initial_error should be 1.0"</span>
            <span class=p>)</span>
        <span class=n>errors</span> <span class=o>=</span> <span class=n>initial_error</span>
<span class=hll>    <span class=k>elif</span> <span class=n>initial_error_strategy</span> <span class=o>==</span> <span class=s2>"addition"</span><span class=p>:</span>  <span class=c1># (4)</span>
</span><span class=hll>        <span class=n>errors</span> <span class=o>=</span> <span class=n>errors</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>initial_error</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s2>"index"</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span>
</span>    <span class=k>else</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=sa>f</span><span class=s2>"Invalid initial_error_strategy: </span><span class=si>{</span><span class=n>initial_error_strategy</span><span class=si>}</span><span class=s2>,"</span>
            <span class=sa>f</span><span class=s2>"should be 'assign' or 'addition'"</span>
        <span class=p>)</span>
    <span class=k>return</span> <span class=n>errors</span>
</code></pre></div></td></tr></table></div> <ol> <li>保证<code>initial_error</code>的 index 和<code>errors</code>的 index 一致，方便后续的计算。</li> <li>赋值策略下，因为是完全替换掉原有的 worker 混淆矩阵，所以需要保证<code>initial_error</code>中包含了所有的 worker 混淆矩阵。</li> <li>赋值策略下，是允许混淆矩阵是 count 或者 probability 的。如果检查到传入的混淆矩阵是 probability，需要保证混淆矩阵的合法性。</li> <li>加法策略下，是将传入的混淆矩阵加到原有的混淆矩阵上。注意，这里需要保证传入的混淆矩阵的值为 count 而不是 probability (这点在<a href=https://crowd-kit.readthedocs.io/en/latest/classification/#crowdkit.aggregation.classification.DawidSkene.initial_error_strategy>文档</a> 做了特别说明)。</li> </ol> <div class=footnote> <hr> <ol> <li id=fn:1> <p>S. Borman, “The expectation maximization algorithm-a short tutorial,” <em>Submitted for publication</em>, vol. 41, 2004. <a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">↩</a></p> </li> <li id=fn:2> <p>A. P. Dawid and A. M. Skene, “Maximum likelihood estimation of observer error-rates using the EM algorithm,” <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, vol. 28, no. 1, pp. 20–28, 1979. <a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">↩</a></p> </li> </ol> </div></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2025年2月20日</span> </span> <span class=md-source-file__fact> <span class=md-icon title=创建日期> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年8月22日</span> </span> <span class=md-source-file__fact> <span class=md-icon title=贡献者> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/shenxiangzhuang class=md-author title=@shenxiangzhuang> <img src="https://avatars.githubusercontent.com/u/17157965?v=4&size=72" alt=shenxiangzhuang> </a> <a href=https://github.com/web-flow class=md-author title=@web-flow> <img src="https://avatars.githubusercontent.com/u/19864447?v=4&size=72" alt=web-flow> </a> </nav> </span> </aside> <script src=https://giscus.app/client.js data-repo=shenxiangzhuang/shenxiangzhuang.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk4MjU0MjM1OQ==" data-category=Announcements data-category-id=DIC_kwDOBOt_F84CTHBH data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async>
</script> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2017 - 2024 Xiangzhuang Shen </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://datahonor.com/feed_rss_created target=_blank rel=noopener title=datahonor.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20 5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27zm0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93z"/></svg> </a> <a href=https://github.com/shenxiangzhuang target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://twitter.com/MathewShen42 target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg> </a> <a href=https://linkedin.com/in/mathewshen target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=mailto:datahonor@gmail.com target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg> </a> <a href=https://mp.weixin.qq.com/s/wOqp6nHBAenK9wP2vIUS9g target=_blank rel=noopener title=mp.weixin.qq.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 0 1 .213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.33.33 0 0 0 .167-.054l1.903-1.114a.86.86 0 0 1 .717-.098 10.2 10.2 0 0 0 2.837.403c.276 0 .543-.027.811-.05-.857-2.578.157-4.972 1.932-6.446 1.703-1.415 3.882-1.98 5.853-1.838-.576-3.583-4.196-6.348-8.596-6.348M5.785 5.991c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178A1.17 1.17 0 0 1 4.623 7.17c0-.651.52-1.18 1.162-1.18zm5.813 0c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178 1.17 1.17 0 0 1-1.162-1.178c0-.651.52-1.18 1.162-1.18m5.34 2.867c-1.797-.052-3.746.512-5.28 1.786-1.72 1.428-2.687 3.72-1.78 6.22.942 2.453 3.666 4.229 6.884 4.229.826 0 1.622-.12 2.361-.336a.72.72 0 0 1 .598.082l1.584.926a.3.3 0 0 0 .14.047c.134 0 .24-.111.24-.247 0-.06-.023-.12-.038-.177l-.327-1.233a.6.6 0 0 1-.023-.156.49.49 0 0 1 .201-.398C23.024 18.48 24 16.82 24 14.98c0-3.21-2.931-5.837-6.656-6.088V8.89c-.135-.01-.27-.027-.407-.03zm-2.53 3.274c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.97-.982zm4.844 0c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982"/></svg> </a> <a href=https://www.zhihu.com/people/shen-xiang-zhuang target=_blank rel=noopener title=www.zhihu.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5.721 0C2.251 0 0 2.25 0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75 0 18.281 0zm1.964 4.078q-.408 1.096-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58 58 0 0 1-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.2 9.2 0 0 1-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125M13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">同意</button> <label class=md-button for=__settings>管理设定</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../../../../..", "features": ["content.action.edit", "content.action.view", "announce.dismiss", "content.code.annotate", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.prune", "navigation.sections", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow", "content.code.annotate"], "search": "../../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../../../../assets/javascripts/bundle.83f73b43.min.js></script> <script src=../../../../../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>